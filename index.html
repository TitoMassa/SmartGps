<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Move Pro</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#3f51b5"/>
</head>
<body>
    <header>
        <h1>Smart Move Pro</h1>
    </header>
    <div id="map"></div>
    <div class="controls-panel">
        <div class="control-group">
            <h3>Definición de Ruta</h3>
            <div>
                <label for="startLat">Latitud Inicio:</label>
                <input type="number" id="startLat" step="any" placeholder="Ej: -34.6037">
                <label for="startLng">Longitud Inicio:</label>
                <input type="number" id="startLng" step="any" placeholder="Ej: -58.3816">
                <label for="startName">Nombre Inicio (Ej: Terminal):</label>
                <input type="text" id="startName" value="Inicio">
                <label for="startTime">Hora Salida Programada Inicio:</label>
                <input type="time" id="startTime">
            </div>
            <div>
                <label for="endLat">Latitud Fin:</label>
                <input type="number" id="endLat" step="any" placeholder="Ej: -34.5889">
                <label for="endLng">Longitud Fin:</label>
                <input type="number" id="endLng" step="any" placeholder="Ej: -58.4000">
                <label for="endName">Nombre Fin (Ej: Plaza):</label>
                <input type="text" id="endName" value="Fin">
                <label for="endTime">Hora Llegada Programada Fin:</label>
                <input type="time" id="endTime">
            </div>
            <p>Toca el mapa para añadir paradas intermedias (después de definir Inicio/Fin).</p>
            <div>
                <input type="checkbox" id="autoCalcTimes" checked>
                <label for="autoCalcTimes">Calcular horarios intermedios automáticamente</label>
            </div>
            <div id="intermediateStopManualTime" style="display:none;">
                <label for="intermediateTime">Hora Llegada/Paso Parada Intermedia:</label>
                <input type="time" id="intermediateTime">
            </div>
        </div>

        <div class="control-group">
            <h3>Paradas de la Ruta Actual</h3>
            <ul id="stopsList"></ul>
        </div>

        <div class="control-group">
            <h3>Gestión de Rutas</h3>
            <label for="routeName">Nombre de Ruta:</label>
            <input type="text" id="routeName" placeholder="Ej: Linea 101 - Ramal A">
            <button id="saveRouteBtn">Guardar Ruta</button>
            <hr>
            <label for="loadRouteSelect">Cargar Ruta:</label>
            <select id="loadRouteSelect"></select>
            <button id="loadRouteBtn">Cargar Seleccionada</button>
            <button id="deleteRouteBtn" class="danger">Eliminar Seleccionada</button>
        </div>

        <div class="control-group">
            <h3>Cola de Seguimiento</h3>
            <button id="addToQueueBtn">Añadir Ruta Cargada a Cola</button>
            <ul id="trackingQueueDisplay"></ul>
            <button id="clearQueueBtn" class="danger">Limpiar Cola</button>
        </div>
        
        <div class="control-group">
            <h3>Seguimiento en Tiempo Real</h3>
            <button id="startTrackingBtn" class="secondary">Iniciar Seguimiento</button>
            <button id="stopTrackingBtn" class="danger" disabled>Detener Seguimiento</button>
            <div>
                <input type="checkbox" id="manualControlCheckbox">
                <label for="manualControlCheckbox">Control Manual Parada/Ruta</label>
            </div>
            <div class="manual-controls">
                <button id="prevStopBtn" disabled>Parada Anterior</button>
                <button id="nextStopBtn" disabled>Parada Siguiente</button>
            </div>
            <div class="info-display">
                <p>Próxima Parada: <span id="nextStopInfo">---</span></p>
                <p>Diferencia Horario: <span id="timeDiffInfo">---</span></p>
                <p>Estado GPS: <span id="gpsStatus">Inactivo</span></p>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
