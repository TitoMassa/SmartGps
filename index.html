<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Move Pro</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>
    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4CAF50">
</head>
<body>
    <div class="app-container">
        <div id="map"></div>

        <div class="controls-panel">
            <section id="route-definition-panel">
                <h2>Definición de Ruta</h2>
                <div>
                    <label for="routeName">Nombre de Ruta:</label>
                    <input type="text" id="routeName" placeholder="Ej: Línea 1 Mañana">
                </div>
                <div class="point-definition">
                    <button id="btnSetStartPoint">Definir Punto de Inicio</button>
                    <div class="point-details">
                        <input type="text" id="startPointName" placeholder="Nombre Inicio (Ej: Terminal)">
                        <input type="time" id="startPointTime">
                        <span id="startPointCoords">Lat/Lng: (selecciona en mapa)</span>
                    </div>
                </div>
                <div class="point-definition">
                    <button id="btnSetEndPoint">Definir Punto Final</button>
                    <div class="point-details">
                        <input type="text" id="endPointName" placeholder="Nombre Fin (Ej: Plaza)">
                        <input type="time" id="endPointTime">
                        <span id="endPointCoords">Lat/Lng: (selecciona en mapa)</span>
                    </div>
                </div>
                <button id="btnAddIntermediateStop" disabled>Añadir Parada Intermedia (toca el mapa)</button>
                <div>
                    <input type="checkbox" id="autoCalcTimes" checked>
                    <label for="autoCalcTimes">Calcular horarios intermedios automáticamente</label>
                </div>
                <h3>Paradas de la Ruta Actual:</h3>
                <ul id="currentRouteStopsList">
                    <!-- Las paradas se listarán aquí -->
                </ul>
            </section>

            <section id="route-management-panel">
                <h2>Gestión de Rutas</h2>
                <button id="btnSaveRoute">Guardar Ruta Actual</button>
                <div>
                    <label for="savedRoutesSelect">Rutas Guardadas:</label>
                    <select id="savedRoutesSelect"></select>
                    <button id="btnLoadRoute">Cargar Ruta</button>
                    <button id="btnDeleteRoute">Eliminar Ruta</button>
                </div>
            </section>

            <section id="tracking-queue-panel">
                <h2>Cola de Seguimiento</h2>
                <button id="btnAddSelectedToQueue">Añadir Ruta Cargada a Cola</button>
                <h3>Rutas en Cola:</h3>
                <ul id="trackingQueueList">
                    <!-- Rutas en cola se listarán aquí -->
                </ul>
                <button id="btnClearQueue">Limpiar Cola</button>
            </section>

            <section id="tracking-panel">
                <h2>Seguimiento en Tiempo Real</h2>
                <button id="btnStartTracking">Iniciar Seguimiento</button>
                <button id="btnStopTracking" disabled>Detener Seguimiento</button>
                <div id="trackingInfo" style="display:none;">
                    <p><strong>Ruta Activa:</strong> <span id="activeRouteName">---</span></p>
                    <p><strong>Próxima Parada:</strong> <span id="nextStopInfo">---</span></p>
                    <p><strong>Diferencia Horario:</strong> <span id="timeDifference">---</span></p>
                </div>
                <div>
                    <input type="checkbox" id="manualModeToggle">
                    <label for="manualModeToggle">Control Manual Parada/Ruta</label>
                </div>
                <div id="manualControls" style="display:none;">
                    <button id="btnPreviousStop">Parada Anterior</button>
                    <button id="btnNextStop">Parada Siguiente</button>
                </div>
            </section>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>
    <script src="js/app.js"></script>
</body>
</html>
